:root{
  --bg:#0a0f1d;
  --card:#11182b;
  --muted:#9aa7c2;
  --text:#f3f6ff;
  --line:#1f2a42;
  --btn:#16233c;
  --btn2:#1c2d4a;
  --accent:#f97316;
  --accent-soft:rgba(249,115,22,0.15);
  --danger:#ffe7ec;
  --danger2:#ffd3dc;
}

body.dark{
  --bg:#f8f9fd;
  --card:#ffffff;
  --muted:#4f5666;
  --text:#101727;
  --line:#e2e7f2;
  --btn:#eef2f9;
  --btn2:#e3e8f3;
  --accent:#f97316;
  --accent-soft:#fff3e8;
  --danger:#ffecef;
  --danger2:#ffd6dd;
}

*{box-sizing:border-box}
body{
  margin:0;
  font:15px/1.6 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  padding-bottom:0; /* nur kleiner Abstand, Inhalt l채uft bis zur Sticky-Bar */
}
.header{
  padding:16px 20px;
  background:var(--card);
  border-bottom:1px solid var(--line);
  box-shadow:0 6px 18px rgba(0,0,0,0.15);
  position:relative;
}
.head-row{display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap}
.brand{display:flex;gap:10px;align-items:flex-start}
.eyebrow{margin:0;font-size:12px;letter-spacing:0.12em;text-transform:uppercase;color:var(--muted)}
h1{margin:2px 0 4px;font-size:22px;letter-spacing:-0.02em}
.sub{margin:0;color:var(--muted)}
.header-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.remember-toggle{color:var(--muted);display:flex;align-items:center;gap:6px;font-size:13px}

.btn{
  background:var(--btn);
  color:var(--text);
  border:1px solid var(--line);
  border-radius:12px;
  padding:8px 12px;
  cursor:pointer;
  transition:background .12s ease, box-shadow .12s ease;
}
.btn:hover{background:var(--btn2);box-shadow:0 6px 12px rgba(0,0,0,0.12)}
.btn.active{background:var(--accent-soft);border-color:var(--accent);color:var(--accent);box-shadow:0 6px 14px rgba(249,115,22,0.2)}
.btn.ghost{background:transparent}
.btn.danger{background:var(--danger);border-color:var(--danger2);color:#8b2237}
.btn.danger.ghost{background:transparent;border-color:var(--danger2);color:#8b2237}
.btn.toggle.active{background:var(--accent-soft);border-color:var(--accent);color:var(--accent)}
.btnwrap{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
.btnwrap.space-between{justify-content:space-between}
.btn.sm{padding:6px 9px;font-size:13px}
.pill{
  padding:7px 10px;
  border-radius:999px;
  border:1px solid var(--line);
  background:var(--btn);
  min-width:54px;
  text-align:center;
}

.seg{display:flex;gap:8px}
.segbtn{
  background:var(--btn);
  color:var(--text);
  border:1px solid var(--line);
  border-radius:999px;
  padding:8px 12px;
  cursor:pointer;
}
.segbtn.active{outline:2px solid rgba(249,115,22,0.35);color:var(--accent)}

.layout{
  position:relative;
  padding:16px;
  max-width:full;
  margin:0 auto;
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
  min-height:calc(100vh - 18vh);
  grid-auto-rows:minmax(auto,1fr);
  align-items:stretch;
}
body.dock-open .layout{grid-template-columns:360px 1fr;}
.dock{display:none;}
body.dock-open .dock{display:block;}
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  box-shadow:0 12px 26px rgba(0,0,0,0.18);
}
.dock-grid{display:grid;grid-template-columns:1fr;gap:12px}
.dock-block{padding:8px;border:1px solid var(--line);border-radius:12px;background:var(--btn)}
.dock-block.compact{padding:8px}
.row{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:8px 0}
label{color:var(--muted)}
select{
  background:var(--btn);
  color:var(--text);
  border:1px solid var(--line);
  border-radius:10px;
  padding:8px 10px;
  min-width:140px;
}
.badge-row{display:flex;gap:8px;align-items:center}
.badge{padding:6px 10px;border-radius:10px;border:1px solid var(--line);background:var(--btn);font-weight:600}
.badge.accent{background:var(--accent-soft);border-color:rgba(249,115,22,0.35);color:var(--accent)}
.note{margin:6px 0;color:var(--muted);font-size:13px}

.preview-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px}
.preview h2{margin:2px 0 0;font-size:18px}
.preview.card{display:flex;flex-direction:column;height:100%}
.title-row{display:flex;flex-direction:column;gap:6px;margin:8px 0 10px}
.title-input{
  padding:10px 12px;
  border:1px solid var(--line);
  border-radius:10px;
  background:#fff;
  font-size:14px;
}

.paper{
  background:#fff;
  border:1px solid var(--line);
  border-radius:12px;
  padding:10px;
  min-height:360px;
  flex:1;
}
.small{color:var(--muted);font-size:12px;margin-top:6px}

.staff-wrap{border:1px solid var(--line);border-radius:14px;padding:10px;background:var(--btn);margin:8px 0}
.staff-wrap .label.inline{display:block;margin-bottom:6px;color:var(--muted);font-weight:600}
.staff{
  width:100%;
  border:1px solid var(--line);
  border-radius:12px;
  background:#fff;
  padding:0px;
  min-height:60px;
  min-width: 350px;
  display:flex;
  align-items:center;
  position:relative;
}
.staff-controls{position:absolute;top:10px;right:10px;display:flex;gap:6px}
.staff-svg{width:100%;height:110px;display:block}
.staff-line{stroke:#9aa3b2;stroke-width:3}
.ledger-line{stroke:#9aa3b2;stroke-width:3;stroke-linecap:round}
.staff-zone{fill:transparent;cursor:pointer}
.staff-zone:hover{fill:rgba(249,115,22,0.12)}
.notehead{fill:#1f2433;cursor:pointer;transition:fill .12s ease}
.notehead:hover{fill:var(--accent)}
.note-label{font-size:11px;fill:#596073;text-anchor:middle;pointer-events:none;user-select:none}
.dark .staff-line{stroke:#1b1b1b}
.dark .ledger-line{stroke:#1b1b1b}
.dark .notehead{fill:#000}
.dark .note-label{fill:#2f2f2f}
/* Dark mode: schwarz, aber mit schlanker Strichst채rke */
body.dark #paper svg *{stroke:#000!important;fill:#000!important;stroke-width:0.8px!important}
body.dark #paper svg rect{fill:none!important;stroke-width:0.8px!important}
body.dark #paper svg text{stroke:none!important;fill:#000!important}
/* Light mode: noch d체nner */
body:not(.dark) #paper svg line,
body:not(.dark) #paper svg path,
body:not(.dark) #paper svg circle,
body:not(.dark) #paper svg ellipse,
body:not(.dark) #paper svg polyline,
body:not(.dark) #paper svg polygon,
body:not(.dark) #paper svg rect{
  stroke-width:0.3px!important;
}
body:not(.dark) #paper svg rect{fill:none;}
/* Spezifisch f체r abcjs-Gruppen (Staff/Layer/Voice) im Darkmode */
body.dark #paper .abcjs-staff *,
body.dark #paper .abcjs-l0 *,
body.dark #paper .abcjs-v0 *{
  stroke:#000!important;
  fill:#000!important;
  stroke-width:0.8px!important;
}

.sticky-bar{
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  height:18vh;
  padding:6px 10px 8px;
  background:rgba(10,15,29,0.9);
  border-top:1px solid var(--line);
  box-shadow:0 -6px 18px rgba(0,0,0,0.25);
  backdrop-filter:blur(8px);
}
body.dark .sticky-bar{background:rgba(255,255,255,0.9)}
.sticky-inner{
  max-width:1200px;
  margin:0 auto;
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;
  padding:4px 6px;
  box-shadow:0 8px 20px rgba(0,0,0,0.12);
  height:100%;
  position:relative;
  overflow:visible;
}
.sticky-inner .label.inline{color:var(--muted);margin-bottom:3px;display:block;font-weight:600}
.sticky-row{display:flex;gap:12px;flex-wrap:wrap;align-items:stretch;height:100%}
.sticky-block{flex:1 1 300px;display:flex;flex-direction:column}
.sticky-block .staff{flex:1;min-height:0}

.theme-fab{
  width:44px;
  height:44px;
  border-radius:14px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
  line-height:1;
}

.dock-tab{
  position:absolute;
  left:-8px;
  top:12px;
  background:var(--accent);
  color:#0a0f1d;
  border:1px solid var(--line);
  border-radius:12px 12px 12px 0;
  padding:10px 8px;
  font-weight:700;
  box-shadow:0 10px 18px rgba(0,0,0,0.18);
  cursor:pointer;
  z-index:6;
  writing-mode:vertical-rl;
  text-orientation:mixed;
  letter-spacing:0.04em;
}
body.dock-open .dock-tab{background:var(--btn);color:var(--text);}
.actions-drawer{
  position:absolute;
  right:7px;
  top:-25px;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:4px;
}
.actions-tab{
  background:var(--accent);
  color:#0a0f1d;
  border:1px solid var(--line);
  border-radius:10px 10px 0 0;
  padding:6px 10px 4px;
  font-weight:700;
  box-shadow:0 10px 18px rgba(0,0,0,0.18);
  cursor:pointer;
}
.actions-panel{
  position:absolute;
  right:0;
  bottom:calc(100% + 8px);
  width:320px;
  background:var(--card);
  border:1px solid var(--line);
  border-radius:12px;
  padding:10px;
  box-shadow:0 18px 32px rgba(0,0,0,0.25);
  transform:translateY(8px);
  opacity:0;
  pointer-events:none;
  transition:transform .18s ease, opacity .18s ease;
  z-index:5;
}
.actions-drawer.open .actions-panel{
  transform:translateY(0);
  opacity:1;
  pointer-events:auto;
}
.actions-panel .btnwrap{flex-wrap:wrap}
.actions-panel .row{margin:10px 0 4px}

@media (max-width: 1100px){
  .layout{grid-template-columns:1fr}
}

@media print{
  body{background:#fff;color:#000;padding-bottom:0}
  .header,.dock,.sticky-bar{display:none}
  .layout{padding:0}
  .preview.card{border:none;box-shadow:none;padding:0}
  .paper{border:1px solid #ccc;border-radius:0;min-height:auto;padding:12px}
  button{display:none}
  .title-row{margin-bottom:12px}
  .title-input{border:none;border-bottom:1px solid #ccc;border-radius:0;padding-left:0}
  #paper svg{width:100%;height:auto}
}
